{"version":3,"sources":["webpack:///./src/views/order/OrderCreation.vue?4a95","webpack:///./src/views/order/Address.vue?215f","webpack:///./src/views/order/OrderPopup.vue?df92","webpack:///./src/components/toast/Toast.vue?8f0e","webpack:///./src/views/order/OrderCreation.vue","webpack:///./src/views/order/Address.vue","webpack:///./src/views/order/Address.vue?6d4e","webpack:///./src/views/order/OrderPopup.vue","webpack:///./src/views/order/OrderPopup.vue?642a","webpack:///./src/views/order/OrderCreation.vue?c861","webpack:///./src/components/toast/Toast.vue","webpack:///./src/components/toast/Toast.vue?22ba"],"names":["class","whiteColor","pageTitle","address","handlePushTo","shopId","showMask","closeMask","handleShowMask","addressId","calculations","price","city","style","department","houseNumber","name","phone","props","render","__scopeId","showmask","handleSubmitOrder","show","message","toastMessage","iconstate","showIcon","ShopInfos","cartProductList","clearCart","showToast","router","isCanceled","products","item","productItem","id","_id","num","count","push","shopName","result","errno","value","localStorage","shopNull","setTimeout","components","Toast","setup","cartList","getAddressList","data","length","addressItem","defaultAddress","console","log","TopTitle","ShopCart","Address","OrderPopup","toastData","icon","success","defeat","state","undefined"],"mappings":"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","file":"js/orderCreation.b46c0552.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./OrderCreation.vue?vue&type=style&index=0&id=0cd829c8&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Address.vue?vue&type=style&index=0&id=9de09886&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./OrderPopup.vue?vue&type=style&index=0&id=314c4bd9&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Toast.vue?vue&type=style&index=0&id=a8bd786c&lang=scss&scoped=true\"","<template>\r\n    <top-title :whiteColor=\"true\" pageTitle=\"确认订单\" />\r\n  <div class=\"main\">\r\n    <Address :address=\"address\" :handlePushTo=\"handlePushTo\" />\r\n    <shop-cart :shopId=\"shopId\" />\r\n  </div>\r\n  <order-popup v-if=\"showMask\" :closeMask=\"handleShowMask\" :addressId=\"addressId\" />\r\n\r\n  <div class=\"shopBootomBar\">\r\n    <div class=\"shopBootomBar__cartTotal\">\r\n      实付金额：<span><i>&yen;</i>{{ calculations.price }}</span>\r\n    </div>\r\n        <div\r\n      class=\"shopBootomBar__orderButton nullClick\"\r\n      v-if=\"!address?.city\"\r\n    >\r\n      提交订单\r\n    </div>\r\n    <div\r\n      class=\"shopBootomBar__orderButton\"\r\n      v-if=\"address?.city\"\r\n      @click=\"() => handleShowMask()\"\r\n    >\r\n      提交订单\r\n    </div>\r\n  </div>\r\n  <div class=\"pagetopBg\"></div>\r\n  <div class=\"pageMainBg\"></div>\r\n</template>\r\n\r\n<script>\r\nimport { useRouter } from \"vue-router\";\r\n\r\nimport {ref} from 'vue';\r\nimport {\r\n  useLocalStorageEffect,\r\n  useCommonCartEffect\r\n} from \"../../components/effects/cartEffect\";\r\n\r\n//获取组件\r\nimport TopTitle from \"../../components/topTitle/TopTitle.vue\";\r\nimport ShopCart from \"../../components/shopcart/ShopCart.vue\";\r\nimport Address from './Address.vue';\r\nimport OrderPopup from './OrderPopup.vue';\r\n\r\n//默认地址相关\r\nimport {get} from '../../utils/request';\r\nconst useAddressEffect=()=>{\r\n  const router = useRouter();\r\n    const address = ref({});\r\n    const addressId = ref('')\r\n    const getAddressList= async()=>{\r\n      try{\r\n        const result= await get('/api/user/address');      \r\n        if (result?.errno === 0&&result?.data?.length>=1) {\r\n          for (const addressItem of result.data) {\r\n              if(addressItem?.defaultAddress){\r\n                address.value = addressItem;\r\n                addressId.value = addressItem._id;\r\n              }\r\n          }                     \r\n        }\r\n      }catch(err){console.log(err)}\r\n    }\r\n    const handlePushTo = () =>{\r\n      router.push(`/address`);\r\n    }\r\n    return {address,getAddressList,handlePushTo,addressId}\r\n}\r\n\r\n//展示隐藏弹窗相关逻辑\r\nconst useShowMaskEffect=()=>{\r\n    const showMask = ref(false);\r\n    const handleShowMask=()=>{\r\n        showMask.value = !showMask.value;\r\n    }\r\n    return {showMask,handleShowMask}\r\n}\r\n\r\n\r\nexport default {\r\n  name: \"OrderCreation\",\r\n  components: { TopTitle, ShopCart,Address,OrderPopup},\r\n  setup() {\r\n\r\n    useLocalStorageEffect(); //打开页面时，从本地获取数据\r\n\r\n    const { shopId, cartList, calculations } = useCommonCartEffect();\r\n\r\n    const {showMask,handleShowMask}=useShowMaskEffect();\r\n\r\n    //获取默认地址\r\n    const {address,getAddressList,handlePushTo,addressId}= useAddressEffect()\r\n    getAddressList();\r\n\r\n    return { shopId, cartList, calculations,showMask,handleShowMask,address,handlePushTo,addressId};\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../../assets/style/variables.scss\";\r\n@import \"../../assets/style/mixins.scss\";\r\n.main {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 1.15rem;\r\n  bottom: 0.99rem; \r\n  z-index: 10;\r\n  overflow-y: auto;\r\n}\r\n\r\n.shopBootomBar {\r\n  position: relative;\r\n  @include bottomBar();\r\n  padding: 0rem;\r\n  &__cartTotal {\r\n    font-size: 0.24rem;\r\n    flex: 1;\r\n    padding: 0rem 0.3rem 0rem 0.4rem;\r\n    span {\r\n      font-size: 0.36rem;\r\n      color: $redColor;\r\n      font-weight: bold;\r\n      i {\r\n        font-size: 0.28rem;\r\n      }\r\n    }\r\n  }\r\n  &__orderButton {\r\n    background: $blueColor;\r\n    color: #fff;\r\n    font-size: 0.28rem;\r\n    height: 100%;\r\n    width: 2rem;\r\n    text-align: center;\r\n    line-height: 0.96rem;\r\n    position: relative;\r\n    &.nullClick{\r\n      opacity:.45;      \r\n    }\r\n    &__a {\r\n      display: block;\r\n      width: 100%;\r\n      height: 100%;\r\n      color: #fff;\r\n    }\r\n  }\r\n}\r\n.pagetopBg {\r\n  height: 3.2rem;\r\n  background-image: linear-gradient(0deg, $pageBgColor 4%, #0091ff 50%);\r\n  background-size: 100%;\r\n  background-repeat: no-repeat;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 1;\r\n}\r\n.pageMainBg {\r\n  position: absolute;\r\n  top: 3.2rem;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: $pageBgColor;\r\n  z-index: 1;\r\n}\r\n</style>\r\n","<template>\r\n    <div class=\"address\"  @click=\"handlePushTo\">\r\n      <div class=\"address__left\">\r\n        <div class=\"address__title\">默认收货地址</div>\r\n        <p class=\"address__text\" v-if=\"!address?.city\" style=\"color:#d60a0a\">暂无地址，去新建地址\r\n        </p>\r\n        <p class=\"address__content\" v-if=\"address?.city\">{{`${address.city}${address.department}${address.houseNumber}`}}\r\n        </p>\r\n        <p class=\"address__text\"  v-if=\"address?.city\">\r\n          <span class=\"address__text__name\">{{address.name}}</span\r\n          ><span class=\"address__text__phone\">{{address.phone}}</span>         \r\n        </p>\r\n      </div>\r\n      <div class=\"address__right\">\r\n        <span class=\"iconfont icon-fanhui1\"></span>\r\n      </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n    name:'Address',\r\n    props:[\"address\",\"handlePushTo\"]\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../../assets/style/variables.scss\";\r\n@import \"../../assets/style/mixins.scss\";\r\n.address {\r\n  margin: 0rem 0.36rem 0.3rem;\r\n  background: #fff;\r\n  border-radius: 0.08rem;\r\n  padding: 0.32rem 0rem 0.32rem;\r\n  display: flex;\r\n  align-content: center;\r\n  justify-content: space-between;\r\n  &__left {\r\n    padding: 0rem 0.3rem;\r\n    flex: 1;\r\n  }\r\n  &__right {\r\n    padding: 0rem 0.24rem 0rem 0rem;\r\n    display: flex;\r\n    align-items: center;\r\n    color: $searchbox-color;\r\n  }\r\n  &__title {\r\n    font-size: 0.32rem;\r\n    margin-bottom: $layout-margin-bottom;\r\n    font-weight: bold;\r\n  }\r\n  &__content {\r\n    padding: 0rem 0rem 0.16rem;\r\n    font-size: 0.28rem;\r\n    line-height: 1.4;\r\n  }\r\n  &__text {\r\n    &__name{margin-right:.4rem}\r\n    font-size: 0.24rem;\r\n    color: $content-fontColor-grey;\r\n  }\r\n}\r\n\r\n</style>","import { render } from \"./Address.vue?vue&type=template&id=9de09886&scoped=true\"\nimport script from \"./Address.vue?vue&type=script&lang=js\"\nexport * from \"./Address.vue?vue&type=script&lang=js\"\n\nimport \"./Address.vue?vue&type=style&index=0&id=9de09886&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-9de09886\"\n\nexport default script","<template>\r\n   <div class=\"mask\" @click=\"()=>closeMask()\" v-if=\"showmask\"></div>\r\n   <div class=\"popup\" v-if=\"showmask\">\r\n       <div class=\"popup__title\">进入收银台</div>\r\n       <div class=\"popup__notice\">请尽快完成支付，否则将被取消</div>\r\n       <div class=\"popup__button\">\r\n           <div class=\"popup__button__cancel\" @click=\"()=>handleSubmitOrder(false)\">待会支付</div>\r\n           <div class=\"popup__button__confirm\" @click=\"()=>handleSubmitOrder(true)\">立即支付</div>\r\n       </div>\r\n   </div>\r\n     <Toast v-if=\"show\" :message=\"toastMessage\" :iconstate='iconstate' :showIcon='showIcon' />\r\n</template>\r\n<script>\r\nimport {ref} from 'vue';\r\nimport { useRouter } from \"vue-router\";\r\nimport { post } from \"../../utils/request\";\r\nimport {\r\n  useCommonCartEffect,\r\n  useShopCartEffect\r\n} from \"../../components/effects/cartEffect\";\r\n\r\nimport Toast, { useToastEffect } from \"../../components/toast/Toast\";\r\n\r\n//点击创建订单逻辑\r\nconst useSubmitOrderEffect=(shopId,ShopInfos,cartProductList,clearCart,showToast,addressId)=>{\r\n    const router =  useRouter();\r\n    const showmask=ref(true);\r\n    const handleSubmitOrder=async(isCanceled)=>{\r\n        const products=[];\r\n        for (const item of cartProductList) {\r\n            const productItem={};\r\n            productItem.id=item._id;\r\n            productItem.num=item.count;\r\n            products.push(productItem);\r\n        }\r\n        try{\r\n            const result = await post('/api/order',{\r\n                addressId,\r\n                shopId,\r\n                shopName:ShopInfos.shopName,\r\n                isCanceled,\r\n                products\r\n            });\r\n            if(result?.errno===0){\r\n                showmask.value=false;\r\n                localStorage.shopNull=true; //不让此页面进入（通过路径或浏览器返回）\r\n                if(isCanceled){\r\n                    showToast(\"支付成功\",'success');\r\n                }else{\r\n                    showToast(\"订单已提交，请尽快支付\",'success');                  \r\n                }                   \r\n                clearCart(shopId);\r\n                setTimeout(()=>{\r\n                    if(isCanceled){\r\n                        router.push({ name: \"Order\" });\r\n                    }else{\r\n                        router.push(`/shop/${shopId}`) \r\n                    }                       \r\n                },1800);   \r\n            }else{\r\n                showToast(\"提交失败\",'defeat');\r\n            }\r\n        }catch(err){\r\n            showToast(\"订单提交失败\",'defeat');\r\n        }\r\n\r\n    }\r\n    return {handleSubmitOrder,showmask}\r\n}\r\n\r\nexport default {\r\n    name:'OrderPopup',\r\n    props:['closeMask','addressId'],\r\n    components:{Toast},\r\n    setup(props){\r\n        \r\n    const { shopId, cartList,clearCart} = useCommonCartEffect();\r\n\r\n    const { ShopInfos, cartProductList } = useShopCartEffect( shopId,\r\ncartList);\r\n\r\n    const { show, toastMessage, showToast,iconstate,showIcon} = useToastEffect();\r\n\r\n    const  {handleSubmitOrder,showmask} = useSubmitOrderEffect(shopId,ShopInfos.value,cartProductList.value,clearCart,showToast,props.addressId);\r\n\r\n    \r\n\r\n    return { handleSubmitOrder,showmask,show, toastMessage, showToast,iconstate,showIcon };\r\n    }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../../assets/style/variables.scss\";\r\n@import \"../../assets/style/mixins.scss\";\r\n.mask {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  z-index: 60;\r\n}\r\n.popup{\r\n    border-radius:.12rem ;\r\n    background: #fff;\r\n    padding: 0.56rem .72rem;\r\n    position: fixed;\r\n    z-index: 61;\r\n    top:50%;\r\n    left:50%;\r\n    transform: translate(-50%,-50%);\r\n    text-align: center;\r\n    &__title{\r\n        font-size: .36rem;\r\n        font-weight: bold;\r\n        margin-bottom: .2rem;\r\n    }\r\n    &__notice{\r\n        color: $content-fontColor-grey;\r\n        font-size: .28rem;\r\n        margin-bottom: .2rem;\r\n        white-space: nowrap;\r\n    }\r\n    &__button{\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        \r\n        &__cancel{\r\n            font-size: .28rem;\r\n            line-height: .68rem;\r\n            height: .72rem;\r\n            width: 1.8rem;\r\n            margin: 0.2rem .1rem 0rem;\r\n            border:.02rem solid #ccc;\r\n            color: $content-notice-fontColor;\r\n            border-radius: .36rem;\r\n        }\r\n        &__confirm{\r\n            font-size:.28rem;\r\n            line-height: .68rem;\r\n            height: .72rem;\r\n            width: 1.8rem;\r\n            margin: 0.2rem .1rem 0rem;\r\n            color:#fff;\r\n            background: $blueColor;\r\n            border-radius: .36rem;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n</style>","import { render } from \"./OrderPopup.vue?vue&type=template&id=314c4bd9&scoped=true\"\nimport script from \"./OrderPopup.vue?vue&type=script&lang=js\"\nexport * from \"./OrderPopup.vue?vue&type=script&lang=js\"\n\nimport \"./OrderPopup.vue?vue&type=style&index=0&id=314c4bd9&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-314c4bd9\"\n\nexport default script","import { render } from \"./OrderCreation.vue?vue&type=template&id=0cd829c8&scoped=true\"\nimport script from \"./OrderCreation.vue?vue&type=script&lang=js\"\nexport * from \"./OrderCreation.vue?vue&type=script&lang=js\"\n\nimport \"./OrderCreation.vue?vue&type=style&index=0&id=0cd829c8&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0cd829c8\"\n\nexport default script","<template>  \r\n  <div class=\"toast\">\r\n  <span v-if='showIcon' :class=\"iconstate\">\r\n  </span>\r\n  <span class=\"toast-text\"> {{ message }}</span>\r\n      </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, toRefs } from \"vue\";\r\n\r\nconst useToastEffect = () => {\r\n  const toastData = reactive({\r\n    show: false,\r\n    toastMessage: \"\",\r\n    icon:{\r\n        success:'iconfont icon-chenggong2',\r\n        defeat:'iconfont icon-shibai1'\r\n    },\r\n    iconstate:'',\r\n    showIcon:false\r\n  });\r\n  const showToast = (message,state='') => {\r\n      \r\n    if(!state){toastData.showIcon=false};\r\n    if(toastData.icon[state]!==undefined){\r\n        toastData.showIcon=true;\r\n        toastData.iconstate=toastData.icon[state];\r\n    }\r\n    toastData.show = true;\r\n    toastData.toastMessage = message;\r\n    setTimeout(() => {\r\n    toastData.show = false;\r\n    toastData.showIcon=false;\r\n    toastData.toastMessage = \"\";\r\n    }, 1800);\r\n  };\r\n  const { show, toastMessage,iconstate,showIcon} = toRefs(toastData);\r\n  return { show, toastMessage, showToast,iconstate,showIcon};\r\n};\r\nexport default {\r\n  name: \"Toast\",\r\n  props:['message','iconstate','showIcon'],\r\n};\r\nexport {useToastEffect}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.toast {\r\n  position: fixed;\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  padding: 0.2rem .4rem .3rem;\r\n  background: rgba(0, 0, 0, 0.35);\r\n  border-radius: 0.1rem;\r\n  display: flex;\r\n  flex-flow: column wrap;\r\n  align-items: center;\r\n  color:#fff;\r\n  z-index: 100;\r\n  span{\r\n      padding:.04rem 0rem;\r\n  }\r\n  .iconfont{\r\n    font-size: 0.64rem;\r\n  }\r\n\r\n}\r\n</style>\r\n","import { render } from \"./Toast.vue?vue&type=template&id=a8bd786c&scoped=true\"\nimport script from \"./Toast.vue?vue&type=script&lang=js\"\nexport * from \"./Toast.vue?vue&type=script&lang=js\"\n\nimport \"./Toast.vue?vue&type=style&index=0&id=a8bd786c&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-a8bd786c\"\n\nexport default script"],"sourceRoot":""}