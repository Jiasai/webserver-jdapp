{"version":3,"sources":["webpack:///./src/views/login/Login.vue?ecc5","webpack:///./src/components/toast/Toast.vue?8f0e","webpack:///./src/assets/images/user.png","webpack:///./src/components/toast/Toast.vue","webpack:///./src/components/toast/Toast.vue?22ba","webpack:///./src/views/login/Login.vue","webpack:///./src/views/login/Login.vue?c907"],"names":["module","exports","class","showIcon","iconstate","message","toastData","show","toastMessage","icon","success","defeat","showToast","state","undefined","setTimeout","name","props","render","__scopeId","src","alt","placeholder","username","type","password","handleLogin","handleToRegister","isPost","data","length","router","url","withCredentials","result","errno","maxAge","push","components","Toast","setup"],"mappings":"kIAAA,W,6DCAA,W,qBCAAA,EAAOC,QAAU,IAA0B,yB,iKCCpCC,MAAM,S,GAGLA,MAAM,c,wEAHZ,eAIU,MAJV,EAIU,CAHE,EAAAC,U,iBAAZ,eACO,Q,MADgBD,MAAO,EAAAE,W,+BAE9B,eAA8C,OAA9C,EAA8C,eAAjB,EAAAC,SAAO,QAOhC,EAAiB,WACrB,IAAMC,EAAY,eAAS,CACzBC,MAAM,EACNC,aAAc,GACdC,KAAK,CACDC,QAAQ,2BACRC,OAAO,yBAEXP,UAAU,GACVD,UAAS,IAELS,EAAY,SAACP,GAAqB,IAAbQ,EAAa,uDAAP,GAE3BA,IAAOP,EAAUH,UAAS,QACHW,IAAxBR,EAAUG,KAAKI,KACdP,EAAUH,UAAS,EACnBG,EAAUF,UAAUE,EAAUG,KAAKI,IAEvCP,EAAUC,MAAO,EACjBD,EAAUE,aAAeH,EACzBU,YAAW,WACXT,EAAUC,MAAO,EACjBD,EAAUH,UAAS,EACnBG,EAAUE,aAAe,KACtB,OAEL,EAAiD,eAAOF,GAAhDC,EAAR,EAAQA,KAAMC,EAAd,EAAcA,aAAaJ,EAA3B,EAA2BA,UAAUD,EAArC,EAAqCA,SACrC,MAAO,CAAEI,OAAMC,eAAcI,YAAUR,YAAUD,aAEpC,GACba,KAAM,QACNC,MAAM,CAAC,UAAU,YAAY,a,UCrC/B,EAAOC,OAASA,EAChB,EAAOC,UAAY,kBAEJ,U,2JCPRjB,MAAM,W,EACT,eAEM,OAFDA,MAAM,gBAAc,CACvB,eAAiD,OAA5CkB,IAAA,IAAmCC,IAAI,O,MAEzCnB,MAAM,kB,GAONA,MAAM,kB,sGAXb,eAsBM,MAtBN,EAsBM,CArBJ,EAGA,eAMM,MANN,EAMM,C,eALJ,eAIE,SAHAA,MAAM,0BACNoB,YAAY,S,qDACH,EAAAC,SAAQ,K,mBAAR,EAAAA,cAGb,eAOM,MAPN,EAOM,C,eANJ,eAKE,SAJArB,MAAM,0BACNoB,YAAY,QACZE,KAAK,W,qDACI,EAAAC,SAAQ,K,mBAAR,EAAAA,cAGb,eAAgE,OAA1D,QAAK,8BAAE,EAAAC,aAAA,EAAAA,YAAA,qBAAaxB,MAAM,yBAAwB,MACxD,eAAqE,OAA/D,QAAK,8BAAE,EAAAyB,kBAAA,EAAAA,iBAAA,qBAAkBzB,MAAM,uBAAsB,QAC9C,EAAAK,M,iBAAb,eAAyF,G,MAArEF,QAAS,EAAAG,aAAeJ,UAAW,EAAAA,UAAYD,SAAU,EAAAA,U,2JAc3EyB,EAAO,SAACC,EAAKjB,GAEjB,QAAGiB,EAAKN,SAASO,OAAO,GAAGD,EAAKJ,SAASK,OAAO,KAC9ClB,EAAU,aACH,IAML,EAAiB,SAAAA,GACrB,IAAMmB,EAAS,iBACTF,EAAO,eAAS,CAAEN,SAAU,GAAIE,SAAU,KAC1CC,EAAU,yDAAI,wHAIZE,EAAOC,EAAKjB,GAJA,wDAKZ,EAAqBiB,EAArBN,SAAS,EAAYM,EAAZJ,SAQVO,EAAM,uCAbO,SAcE,eAAKA,EAAI,CAACT,SAAA,EAASE,SAAA,GAAU,CAACQ,iBAAgB,IAdhD,OAcbC,EAda,OAgBM,KAAZ,OAANA,QAAM,IAANA,OAAA,EAAAA,EAAQC,QAKhB,eAAU,WAAU,EAAK,CAACC,OAAO,SAG3BxB,EAAU,OAAO,WACjBG,YAAW,WACTgB,EAAOM,KAAK,CAAErB,KAAM,WACpB,QAGFX,EAAU6B,EAAO7B,SAAW,OAC5BO,EAAUP,EAAQ,WA/BJ,qDAkChBO,EAAU,OAAO,UAlCD,0DAAJ,qDAqChB,EAA+B,eAAOiB,GAA9BN,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,SAClB,MAAO,CAAEC,cAAaH,WAAUE,aAG5B,EAAsB,WAC1B,IAAMM,EAAS,iBACTJ,EAAmB,WACvBI,EAAOM,KAAK,CAAErB,KAAM,cAEtB,MAAO,CAAEW,qBAGI,GACbX,KAAM,QACNsB,WAAY,CAAEC,QAAA,MAEdC,MAJa,WAKX,MAA4D,iBAApDjC,EAAR,EAAQA,KAAMC,EAAd,EAAcA,aAAcI,EAA5B,EAA4BA,UAAUR,EAAtC,EAAsCA,UAAUD,EAAhD,EAAgDA,SAChD,EAA4C,EAAeS,GAAnDc,EAAR,EAAQA,YAAaH,EAArB,EAAqBA,SAAUE,EAA/B,EAA+BA,SAC/B,EAA6B,IAArBE,EAAR,EAAQA,iBAER,MAAO,CACLD,cACAH,WACAE,WACAE,mBACApB,OACAC,eACAJ,YAAUD,c,UC7GhB,EAAOe,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"js/login.79d40959.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Login.vue?vue&type=style&index=0&id=44414052&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Toast.vue?vue&type=style&index=0&id=a8bd786c&lang=scss&scoped=true\"","module.exports = __webpack_public_path__ + \"img/user.55d798b6.png\";","<template>  \r\n  <div class=\"toast\">\r\n  <span v-if='showIcon' :class=\"iconstate\">\r\n  </span>\r\n  <span class=\"toast-text\"> {{ message }}</span>\r\n      </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, toRefs } from \"vue\";\r\n\r\nconst useToastEffect = () => {\r\n  const toastData = reactive({\r\n    show: false,\r\n    toastMessage: \"\",\r\n    icon:{\r\n        success:'iconfont icon-chenggong2',\r\n        defeat:'iconfont icon-shibai1'\r\n    },\r\n    iconstate:'',\r\n    showIcon:false\r\n  });\r\n  const showToast = (message,state='') => {\r\n      \r\n    if(!state){toastData.showIcon=false};\r\n    if(toastData.icon[state]!==undefined){\r\n        toastData.showIcon=true;\r\n        toastData.iconstate=toastData.icon[state];\r\n    }\r\n    toastData.show = true;\r\n    toastData.toastMessage = message;\r\n    setTimeout(() => {\r\n    toastData.show = false;\r\n    toastData.showIcon=false;\r\n    toastData.toastMessage = \"\";\r\n    }, 1800);\r\n  };\r\n  const { show, toastMessage,iconstate,showIcon} = toRefs(toastData);\r\n  return { show, toastMessage, showToast,iconstate,showIcon};\r\n};\r\nexport default {\r\n  name: \"Toast\",\r\n  props:['message','iconstate','showIcon'],\r\n};\r\nexport {useToastEffect}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.toast {\r\n  position: fixed;\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  padding: 0.2rem .4rem .3rem;\r\n  background: rgba(0, 0, 0, 0.35);\r\n  border-radius: 0.1rem;\r\n  display: flex;\r\n  flex-flow: column wrap;\r\n  align-items: center;\r\n  color:#fff;\r\n  z-index: 100;\r\n  span{\r\n      padding:.04rem 0rem;\r\n  }\r\n  .iconfont{\r\n    font-size: 0.64rem;\r\n  }\r\n\r\n}\r\n</style>\r\n","import { render } from \"./Toast.vue?vue&type=template&id=a8bd786c&scoped=true\"\nimport script from \"./Toast.vue?vue&type=script&lang=js\"\nexport * from \"./Toast.vue?vue&type=script&lang=js\"\n\nimport \"./Toast.vue?vue&type=style&index=0&id=a8bd786c&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-a8bd786c\"\n\nexport default script","<template>\r\n  <div class=\"wrapper\">\r\n    <div class=\"wrapper__img\">\r\n      <img src=\"../../assets/images/user.png\" alt=\"\" />\r\n    </div>\r\n    <div class=\"wrapper__input\">\r\n      <input\r\n        class=\"wrapper__input__content\"\r\n        placeholder=\"请输入用户名\"\r\n        v-model=\"username\"\r\n      />\r\n    </div>\r\n    <div class=\"wrapper__input\">\r\n      <input\r\n        class=\"wrapper__input__content\"\r\n        placeholder=\"请输入密码\"\r\n        type=\"password\"\r\n        v-model=\"password\"\r\n      />\r\n    </div>\r\n    <div @click=\"handleLogin\" class=\"wrapper__login-button\">登录</div>\r\n    <div @click=\"handleToRegister\" class=\"wrapper__login-link\">立即注册</div>\r\n    <Toast v-if=\"show\" :message=\"toastMessage\" :iconstate='iconstate' :showIcon='showIcon' />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//主动跳转，用useRouter的 push方法\r\nimport { reactive, toRefs } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { post } from \"../../utils/request\";\r\nimport axios from 'axios';\r\nimport {setCookie} from \"../../utils/cookie.js\";\r\nimport Toast, { useToastEffect } from \"../../components/toast/Toast\";\r\n\r\n//判断是否发送请求\r\nconst isPost=(data,showToast)=>{\r\n  /*--这里可以做一系列验证方法，比如不能是空格，密码格式等等---*/\r\n  if(data.username.length<3||data.password.length<3){\r\n    showToast(\"输入字符长度不足\");\r\n    return false;\r\n  }else{return true}\r\n  \r\n}\r\n\r\n//登录相关逻辑\r\nconst useLoginEffect = showToast => {\r\n  const router = useRouter();\r\n  const data = reactive({ username: \"\", password: \"\" });\r\n  const handleLogin = async () => {\r\n    try {\r\n      \r\n      //验证输入\r\n      if(!isPost(data,showToast)) return;\r\n\t  const {username,password} = data;\r\n\t  /* const url = '/api/user/login';\r\n      const result = await post(url, {\r\n        username: data.username,\r\n        password: data.password\r\n      }); */\r\n\t  \r\n\t  //本地nodejs自建服务端 localhost:3000\r\n\t  const url = 'http://localhost:3000/api/user/login';\r\n\t  const result = await post(url,{username,password},{withCredentials:true});\r\n\t      \r\n      if (result?.errno === 0) {\r\n\t\t  \r\n\t\t //之所以使用cookie，是因为到期失效（15天），跟服务器保持一致（服务器登录设置的cookie就是15天），\r\n\t\t //cookie失效，重新登录，触发服务器重新设置返回cookie\r\n\t\t \r\n\t\tsetCookie(\"isLogin\",true,{maxAge:15*24*60*60})////有效期15天,maxAge单位：秒\r\n\t\t//console.log(getCookieValue(\"isLogin\"));\r\n\r\n        showToast(\"登录成功\",'success');\r\n        setTimeout(()=>{\r\n          router.push({ name: \"Home\" });\r\n        },1600);   \r\n\r\n      } else {\r\n\t\tconst message = result.message || \"登录失败\";\r\n        showToast(message,'defeat');\r\n      }\r\n    } catch (err) {\r\n      showToast(\"请求失败\",'defeat');\r\n    }\r\n  };\r\n  const { username, password } = toRefs(data);\r\n  return { handleLogin, username, password };\r\n};\r\n//路由跳转注册页\r\nconst useToRegisterEffect = () => {\r\n  const router = useRouter();\r\n  const handleToRegister = () => {\r\n    router.push({ name: \"Register\" });\r\n  };\r\n  return { handleToRegister };\r\n};\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  components: { Toast },\r\n  //setup函数的职责：就是告诉你，代码执行的一个流程，细节代码统统是引入\r\n  setup() {\r\n    const { show, toastMessage, showToast,iconstate,showIcon} = useToastEffect();\r\n    const { handleLogin, username, password } = useLoginEffect(showToast);\r\n    const { handleToRegister } = useToRegisterEffect();\r\n\r\n    return {\r\n      handleLogin,\r\n      username,\r\n      password,\r\n      handleToRegister,\r\n      show,\r\n      toastMessage,\r\n      iconstate,showIcon\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../assets/style/variables.scss\";\r\n.wrapper {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 0;\r\n  right: 0;\r\n  transform: translateY(-50%);\r\n  &__img {\r\n    width: 1.56rem;\r\n    height: 1.56rem;\r\n    margin: 0 auto 0.8rem;\r\n    img {\r\n      width: 100%;\r\n    }\r\n  }\r\n  &__input {\r\n    background: #f9f9f9;\r\n    border: 1px solid rgba(0, 0, 0, 0.1);\r\n    border-radius: 0.12rem;\r\n    height: 0.96rem;\r\n    margin: 0 0.8rem 0.32rem;\r\n    &__content {\r\n      width: 100%;\r\n      height: 100%;\r\n      background: none;\r\n      padding: 0 0.3rem;\r\n      font-size: 0.32rem;\r\n    }\r\n    &__content::-webkit-input-placeholder {\r\n      color: $searchbox-color;\r\n    }\r\n    &__content:-moz-placeholder {\r\n      color: $searchbox-color;\r\n    }\r\n    &__content::-moz-placeholder {\r\n      color: $searchbox-color;\r\n    }\r\n    &__content:-ms-input-placeholder {\r\n      color: $searchbox-color;\r\n    }\r\n  }\r\n  &__login-button {\r\n    background: #e30b0b;\r\n    box-shadow: 0 4px 8px 0 rgba(255, 0, 0, 0.32);\r\n    border-radius: 4px;\r\n    color: #fff;\r\n    font-size: 0.32rem;\r\n    height: 0.96rem;\r\n    margin: 0.64rem 0.8rem 0.1rem;\r\n    line-height: 0.96rem;\r\n    text-align: center;\r\n  }\r\n  &__login-link {\r\n    font-size: 0.28rem;\r\n    height: 0.96rem;\r\n    margin: 0 0.8rem 0;\r\n    line-height: 0.96rem;\r\n    text-align: center;\r\n    color: $content-notice-fontColor;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./Login.vue?vue&type=template&id=44414052&scoped=true\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=44414052&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-44414052\"\n\nexport default script"],"sourceRoot":""}